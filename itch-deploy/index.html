<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tsext Adventure: Halloween Haunt</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(255, 107, 53, 0.3);
            border: 2px solid #ff6b35;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 2.5em;
            color: #ff6b35;
            text-shadow: 0 0 10px #ff6b35;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #8b5cf6;
            margin-bottom: 20px;
        }

        .warning {
            background: rgba(255, 107, 53, 0.2);
            border: 1px solid #ff6b35;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .game-area {
            min-height: 400px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #333;
        }

        .scene-title {
            font-size: 1.5em;
            color: #ff6b35;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid #ff6b35;
            padding-bottom: 10px;
        }

        .scene-description {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 20px;
            color: #e0e0e0;
        }

        .choices {
            margin-top: 20px;
        }

        .choice {
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid #8b5cf6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .choice:hover {
            background: rgba(139, 92, 246, 0.4);
            transform: translateX(5px);
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.5);
        }

        .ending {
            text-align: center;
            padding: 20px;
            background: rgba(255, 107, 53, 0.1);
            border-radius: 10px;
            border: 2px solid #ff6b35;
        }

        .ending-title {
            font-size: 1.8em;
            color: #ff6b35;
            margin-bottom: 15px;
        }

        .ending-outcome {
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .score {
            font-size: 1.1em;
            color: #8b5cf6;
            margin-bottom: 15px;
        }

        .restart-btn {
            background: linear-gradient(45deg, #ff6b35, #8b5cf6);
            border: none;
            border-radius: 25px;
            padding: 12px 30px;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .restart-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.5);
        }

        .start-screen {
            text-align: center;
        }

        .player-input {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #8b5cf6;
            border-radius: 10px;
            padding: 15px;
            color: white;
            font-size: 1.1em;
            width: 100%;
            max-width: 300px;
            margin: 20px auto;
            text-align: center;
        }

        .start-btn {
            background: linear-gradient(45deg, #8b5cf6, #ff6b35);
            border: none;
            border-radius: 25px;
            padding: 15px 40px;
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(139, 92, 246, 0.5);
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            color: #666;
            font-size: 0.9em;
        }

        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 3px solid #ff6b35;
            border-radius: 15px;
            padding: 30px;
            z-index: 1000;
            text-align: center;
            box-shadow: 0 0 50px rgba(255, 107, 53, 0.5);
            animation: achievementPop 0.5s ease-out;
        }

        @keyframes achievementPop {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.8; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .achievement-icon {
            font-size: 4em;
            margin-bottom: 15px;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .achievement-title {
            font-size: 1.8em;
            color: #ff6b35;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .achievement-description {
            font-size: 1.1em;
            color: #e0e0e0;
            margin-bottom: 20px;
        }

        .achievement-rarity {
            font-size: 1em;
            padding: 5px 15px;
            border-radius: 20px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .rarity-common { background: #9CA3AF; color: #000; }
        .rarity-rare { background: #3B82F6; color: #fff; }
        .rarity-epic { background: #8B5CF6; color: #fff; }
        .rarity-legendary { background: #F59E0B; color: #000; }

        .achievement-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .share-btn {
            background: linear-gradient(45deg, #ff6b35, #8b5cf6);
            border: none;
            border-radius: 25px;
            padding: 10px 20px;
            color: white;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .share-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 107, 53, 0.5);
        }

        .close-btn {
            background: #666;
            border: none;
            border-radius: 25px;
            padding: 10px 20px;
            color: white;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .close-btn:hover {
            background: #888;
            transform: scale(1.05);
        }

        .achievements-panel {
            position: fixed;
            top: 20px;
            right: -320px;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #8b5cf6;
            border-radius: 10px 0 0 10px;
            padding: 15px;
            z-index: 100;
            max-width: 300px;
            width: 300px;
            max-height: 80vh;
            overflow-y: auto;
            transition: right 0.3s ease;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.5);
        }

        .achievements-panel.open {
            right: 0;
        }

        .achievements-toggle {
            position: fixed;
            top: 50%;
            right: 0;
            transform: translateY(-50%);
            background: linear-gradient(135deg, #8b5cf6, #ff6b35);
            border: 2px solid #8b5cf6;
            border-right: none;
            border-radius: 10px 0 0 10px;
            padding: 15px 10px;
            cursor: pointer;
            z-index: 101;
            transition: all 0.3s ease;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            font-weight: bold;
            color: white;
            font-size: 1em;
        }

        .achievements-toggle:hover {
            padding-left: 15px;
            box-shadow: -5px 0 15px rgba(139, 92, 246, 0.5);
        }

        .achievements-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #8b5cf6;
        }

        .achievements-title {
            font-size: 1.2em;
            color: #8b5cf6;
            font-weight: bold;
        }

        .achievements-close {
            background: transparent;
            border: none;
            color: #ff6b35;
            font-size: 1.5em;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .achievements-close:hover {
            background: rgba(255, 107, 53, 0.2);
            transform: rotate(90deg);
        }

        .achievement-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 8px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .achievement-item:hover {
            background: rgba(139, 92, 246, 0.2);
            transform: translateX(5px);
            border-color: rgba(139, 92, 246, 0.5);
        }

        .achievement-item.unlocked {
            background: rgba(255, 107, 53, 0.2);
            border-color: rgba(255, 107, 53, 0.5);
        }

        .achievement-item.unlocked:hover {
            background: rgba(255, 107, 53, 0.3);
            box-shadow: 0 0 10px rgba(255, 107, 53, 0.3);
        }

        .achievement-item-icon {
            font-size: 2em;
            margin-right: 12px;
            min-width: 40px;
            text-align: center;
        }

        .achievement-item-text {
            flex: 1;
        }

        .achievement-item-name {
            font-size: 0.95em;
            color: #fff;
            font-weight: bold;
            margin-bottom: 3px;
        }

        .achievement-item-desc {
            font-size: 0.8em;
            color: #ccc;
            line-height: 1.3;
        }

        .stats-panel {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #ff6b35;
            border-radius: 10px;
            padding: 15px;
            z-index: 100;
            min-width: 200px;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.5);
        }

        .stats-title {
            font-size: 1.2em;
            color: #ff6b35;
            margin-bottom: 10px;
            text-align: center;
            font-weight: bold;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: #e0e0e0;
            padding: 5px;
            border-radius: 5px;
            background: rgba(255, 107, 53, 0.1);
        }

        .stat-item span:first-child {
            font-weight: 600;
        }

        .stat-item span:last-child {
            color: #ff6b35;
            font-weight: bold;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
        }

        .loading {
            text-align: center;
            color: #8b5cf6;
            font-size: 1.2em;
        }

        /* RWD - 平板和小螢幕 */
        @media (max-width: 1024px) {
            .stats-panel {
                top: 10px;
                left: 10px;
                min-width: 150px;
                font-size: 0.9em;
            }

            .achievements-panel {
                width: 250px;
                right: -270px;
            }

            .achievements-toggle {
                font-size: 0.9em;
                padding: 12px 8px;
            }
        }

        /* RWD - 手機橫向 */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                margin: 10px;
            }
            
            .title {
                font-size: 1.8em;
            }

            .subtitle {
                font-size: 1em;
            }
            
            .scene-title {
                font-size: 1.2em;
            }

            .scene-description {
                font-size: 1em;
            }

            .choice {
                font-size: 0.95em;
                padding: 12px;
            }

            .stats-panel {
                top: 10px;
                left: 10px;
                min-width: 120px;
                font-size: 0.85em;
                padding: 10px;
            }

            .stats-title {
                font-size: 1em;
            }

            .stat-item {
                font-size: 0.85em;
                margin-bottom: 5px;
            }

            .achievements-panel {
                width: 220px;
                right: -240px;
                max-height: 70vh;
            }

            .achievements-toggle {
                font-size: 0.85em;
                padding: 10px 6px;
            }

            .achievement-popup {
                width: 90%;
                max-width: 350px;
                padding: 20px;
            }

            .achievement-icon {
                font-size: 3em;
            }

            .achievement-title {
                font-size: 1.5em;
            }

            .share-btn, .close-btn {
                font-size: 0.9em;
                padding: 8px 15px;
            }
        }

        /* RWD - 手機直向 */
        @media (max-width: 480px) {
            .container {
                padding: 10px;
                margin: 5px;
            }

            .title {
                font-size: 1.5em;
            }

            .subtitle {
                font-size: 0.9em;
            }

            .warning {
                font-size: 0.9em;
                padding: 10px;
            }

            .scene-title {
                font-size: 1.1em;
            }

            .scene-description {
                font-size: 0.95em;
            }

            .choice {
                font-size: 0.9em;
                padding: 10px;
            }

            .stats-panel {
                position: relative;
                top: 0;
                left: 0;
                width: 100%;
                margin-bottom: 10px;
                box-sizing: border-box;
            }

            .achievements-panel {
                width: 85%;
                right: -90%;
                top: 60px;
                max-height: 60vh;
            }

            .achievements-toggle {
                top: 65%;
                font-size: 0.8em;
                padding: 8px 5px;
            }

            .achievement-popup {
                width: 95%;
                padding: 15px;
            }

            .achievement-icon {
                font-size: 2.5em;
            }

            .achievement-title {
                font-size: 1.3em;
            }

            .achievement-description {
                font-size: 0.95em;
            }

            .share-btn, .close-btn {
                font-size: 0.85em;
                padding: 6px 12px;
                margin: 3px;
            }

            .achievement-actions {
                flex-direction: column;
            }

            .achievement-actions button {
                width: 100%;
            }

            .player-input {
                width: 90%;
                font-size: 1em;
            }

            .start-btn, .restart-btn {
                font-size: 1em;
                padding: 12px 30px;
            }
        }

        /* RWD - 超小螢幕 */
        @media (max-width: 360px) {
            .title {
                font-size: 1.3em;
            }

            .scene-title {
                font-size: 1em;
            }

            .scene-description {
                font-size: 0.9em;
            }

            .choice {
                font-size: 0.85em;
                padding: 8px;
            }
        }

        /* 捲軸樣式 */
        .achievements-panel::-webkit-scrollbar {
            width: 8px;
        }

        .achievements-panel::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .achievements-panel::-webkit-scrollbar-thumb {
            background: #8b5cf6;
            border-radius: 4px;
        }

        .achievements-panel::-webkit-scrollbar-thumb:hover {
            background: #a78bfa;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">🎃 Tsext Adventure: Halloween Haunt 🎃</h1>
            <p class="subtitle">萬聖節瑟瑟冒險遊戲</p>
        </div>

        <div class="warning">
            ⚠️ <strong>NSFW 警告</strong>：本遊戲包含成人暗示和幽默，適合 18 歲以上玩家
        </div>

        <!-- 統計面板 -->
        <div class="stats-panel" id="statsPanel" style="display: none;">
            <div class="stats-title">📊 遊戲統計</div>
            <div class="stat-item">
                <span>總分數:</span>
                <span id="totalScore">0</span>
            </div>
            <div class="stat-item">
                <span>遊玩次數:</span>
                <span id="playCount">0</span>
            </div>
            <div class="stat-item">
                <span>解鎖成就:</span>
                <span id="achievementCount">0</span>
            </div>
            <div class="stat-item">
                <span>探索場景:</span>
                <span id="sceneCount">0</span>
            </div>
        </div>

        <!-- 成就切換按鈕 -->
        <div class="achievements-toggle" id="achievementsToggle" onclick="toggleAchievementsPanel()" style="display: none;">
            🏆 成就列表
        </div>

        <!-- 成就面板 -->
        <div class="achievements-panel" id="achievementsPanel">
            <div class="achievements-header">
                <div class="achievements-title">🏆 成就列表</div>
                <button class="achievements-close" onclick="toggleAchievementsPanel()">✕</button>
            </div>
            <div id="achievementsList"></div>
        </div>

        <div class="game-area" id="gameArea">
            <div class="start-screen" id="startScreen">
                <h2>👻 歡迎來到萬聖節靈異約會趴！</h2>
                <p>準備好參加最刺激的萬聖節冒險了嗎？</p>
                <input type="text" class="player-input" id="playerName" placeholder="請輸入你的名字" maxlength="20">
                <br>
                <button class="start-btn" onclick="startGame()">開始冒險 🎃</button>
            </div>
        </div>

        <div class="footer">
            <p>🎃 Happy Halloween! 🎃</p>
            <p>開源專案 | MIT License | <a href="https://github.com/yourusername/tsext-adventure" style="color: #8b5cf6;">GitHub</a></p>
        </div>
    </div>

    <script>
        // 遊戲狀態
        let gameState = {
            currentScene: 'start',
            playerName: '',
            score: 0,
            visitedScenes: new Set(),
            unlockedAchievements: new Set(),
            unlockedBadges: new Set(),
            playCount: 0,
            totalScore: 0,
            gameStartTime: null,
            allEndingsUnlocked: new Set(),
            allScenesVisited: new Set(),
            punsTriggered: new Set()
        };

        // 成就資料
        const achievementsData = {
            "magic_knight": {
                "name": "魔法騎士",
                "description": "與女巫達成完美結局",
                "icon": "🧙‍♀️",
                "rarity": "legendary",
                "condition": "ending_rooftop_romance",
                "points": 100
            },
            "moonlight_lover": {
                "name": "月光戀人",
                "description": "在月光湖度過浪漫夜晚",
                "icon": "🌙",
                "rarity": "epic",
                "condition": "ending_moonlight_adventure",
                "points": 90
            },
            "ghost_lover": {
                "name": "鬼魂戀人",
                "description": "與鬼魂體驗奇異親密",
                "icon": "👻",
                "rarity": "rare",
                "condition": "ending_ghost_intimacy",
                "points": 85
            },
            "pumpkin_master": {
                "name": "南瓜大師",
                "description": "在南瓜田發揮創意",
                "icon": "🎃",
                "rarity": "rare",
                "condition": "ending_big_pumpkin_fun",
                "points": 75
            },
            "field_lover": {
                "name": "田野戀人",
                "description": "與農夫女郎度過激情夜晚",
                "icon": "🌾",
                "rarity": "epic",
                "condition": "ending_farmer_seduction",
                "points": 95
            },
            "cat_friend": {
                "name": "貓咪之友",
                "description": "與黑貓咪咪建立友誼",
                "icon": "🐱",
                "rarity": "common",
                "condition": "ending_cat_adventure",
                "points": 60
            },
            "cat_lady_lover": {
                "name": "貓女戀人",
                "description": "與貓女莉莉度過浪漫時光",
                "icon": "🐱‍👤",
                "rarity": "rare",
                "condition": "ending_cat_lady_romance",
                "points": 80
            },
            "soul_mate": {
                "name": "心靈伴侶",
                "description": "與農夫女郎建立情感連接",
                "icon": "💕",
                "rarity": "rare",
                "condition": "ending_heart_to_heart",
                "points": 85
            },
            "passion_lover": {
                "name": "激情戀人",
                "description": "體驗火熱的激情夜晚",
                "icon": "🔥",
                "rarity": "epic",
                "condition": "ending_physical_attraction",
                "points": 90
            },
            "cold_warrior": {
                "name": "冰冷戰士",
                "description": "勇敢面對鬼魂的冰冷觸摸",
                "icon": "❄️",
                "rarity": "common",
                "condition": "ending_cold_encounter",
                "points": 70
            },
            "floating_fool": {
                "name": "漂浮傻瓜",
                "description": "因為無禮而漂浮撞壞吊燈",
                "icon": "💥",
                "rarity": "common",
                "condition": "ending_floating_mischief",
                "points": 30
            },
            "pumpkin_crusher": {
                "name": "南瓜粉碎者",
                "description": "摔碎南瓜但學到教訓",
                "icon": "🎃💥",
                "rarity": "common",
                "condition": "ending_pumpkin_lifting",
                "points": 20
            },
            "ghost_chaser": {
                "name": "鬼魂追逐者",
                "description": "被鬼魂追逐最後絆倒",
                "icon": "🏃‍♂️👻",
                "rarity": "common",
                "condition": "ending_ghost_chase",
                "points": 25
            },
            "explorer": {
                "name": "探索者",
                "description": "探索了所有主要場景",
                "icon": "🗺️",
                "rarity": "rare",
                "condition": "visited_all_scenes",
                "points": 50
            },
            "completionist": {
                "name": "完美主義者",
                "description": "解鎖了所有結局",
                "icon": "🏆",
                "rarity": "legendary",
                "condition": "all_endings_unlocked",
                "points": 200
            },
            "speed_demon": {
                "name": "速度惡魔",
                "description": "在 5 分鐘內完成遊戲",
                "icon": "⚡",
                "rarity": "rare",
                "condition": "speed_run_5min",
                "points": 75
            },
            "pun_master": {
                "name": "雙關語大師",
                "description": "觸發了所有萬聖節雙關語",
                "icon": "😄",
                "rarity": "epic",
                "condition": "all_puns_triggered",
                "points": 100
            },
            "romance_expert": {
                "name": "浪漫專家",
                "description": "達成所有浪漫結局",
                "icon": "💘",
                "rarity": "rare",
                "condition": "all_romance_endings",
                "points": 80
            },
            "adventure_seeker": {
                "name": "冒險尋求者",
                "description": "嘗試了所有冒險選擇",
                "icon": "🗡️",
                "rarity": "rare",
                "condition": "all_adventure_choices",
                "points": 70
            },
            "halloween_legend": {
                "name": "萬聖節傳奇",
                "description": "獲得 1000 分以上",
                "icon": "🎃👑",
                "rarity": "legendary",
                "condition": "score_1000_plus",
                "points": 300
            }
        };

        // 徽章資料
        const badgesData = {
            "first_play": {
                "name": "初來乍到",
                "description": "第一次遊玩",
                "icon": "👶",
                "rarity": "common"
            },
            "night_owl": {
                "name": "夜貓子",
                "description": "在深夜時分遊玩",
                "icon": "🦉",
                "rarity": "common"
            },
            "early_bird": {
                "name": "早起鳥",
                "description": "在清晨時分遊玩",
                "icon": "🐦",
                "rarity": "common"
            },
            "weekend_warrior": {
                "name": "週末戰士",
                "description": "在週末遊玩",
                "icon": "⚔️",
                "rarity": "common"
            },
            "repeat_player": {
                "name": "重複玩家",
                "description": "遊玩超過 5 次",
                "icon": "🔄",
                "rarity": "rare"
            },
            "social_butterfly": {
                "name": "社交蝴蝶",
                "description": "分享了 3 次成就",
                "icon": "🦋",
                "rarity": "rare"
            },
            "perfectionist": {
                "name": "完美主義者",
                "description": "單次遊戲獲得滿分",
                "icon": "💯",
                "rarity": "epic"
            },
            "lucky_charm": {
                "name": "幸運符",
                "description": "連續 3 次獲得稀有成就",
                "icon": "🍀",
                "rarity": "epic"
            },
            "halloween_spirit": {
                "name": "萬聖節精神",
                "description": "在萬聖節期間遊玩",
                "icon": "🎃",
                "rarity": "rare"
            },
            "midnight_magic": {
                "name": "午夜魔法",
                "description": "在午夜時分完成遊戲",
                "icon": "🕛",
                "rarity": "rare"
            }
        };

        // 社交平台資料
        const socialPlatforms = {
            "twitter": {
                "name": "Twitter",
                "icon": "🐦",
                "url": "https://twitter.com/intent/tweet",
                "hashtags": ["TsextAdventure", "HalloweenHaunt", "NSFWGame"]
            },
            "facebook": {
                "name": "Facebook",
                "icon": "📘",
                "url": "https://www.facebook.com/sharer/sharer.php",
                "hashtags": ["TsextAdventure", "HalloweenHaunt"]
            },
            "instagram": {
                "name": "Instagram",
                "icon": "📷",
                "url": "https://www.instagram.com/",
                "hashtags": ["#TsextAdventure", "#HalloweenHaunt", "#NSFWGame"]
            },
            "threads": {
                "name": "Threads",
                "icon": "🧵",
                "url": "https://www.threads.net/intent/post",
                "hashtags": ["#TsextAdventure", "#HalloweenHaunt"]
            },
            "line": {
                "name": "LINE",
                "icon": "💬",
                "url": "https://social-plugins.line.me/lineit/share",
                "hashtags": ["TsextAdventure", "HalloweenHaunt"]
            },
            "discord": {
                "name": "Discord",
                "icon": "💬",
                "url": "https://discord.com/",
                "hashtags": ["TsextAdventure", "HalloweenHaunt"]
            },
            "reddit": {
                "name": "Reddit",
                "icon": "🤖",
                "url": "https://reddit.com/submit",
                "hashtags": ["TsextAdventure", "HalloweenHaunt", "NSFWGame"]
            },
            "telegram": {
                "name": "Telegram",
                "icon": "✈️",
                "url": "https://t.me/share/url",
                "hashtags": ["TsextAdventure", "HalloweenHaunt"]
            }
        };

        // 故事資料
        const storyData = {
            "start": {
                "title": "萬聖節靈異約會趴入口",
                "description": "你站在一棟陰森的老宅前，門口掛著「歡迎參加萬聖節靈異約會趴」的牌子。月光透過烏雲灑下，南瓜燈在風中搖曳，發出詭異的光芒。\n\n你聽到屋內傳來笑聲、音樂聲，還有一些... 奇怪的聲音。門口站著一個穿著性感女巫裝的接待員，她對你眨了眨眼。",
                "choices": [
                    {"option": "A: 對女巫說「你的掃帚真漂亮，能騎嗎？」", "next_scene": "witch_encounter"},
                    {"option": "B: 直接進入鬼屋探險", "next_scene": "haunted_house"},
                    {"option": "C: 先去南瓜田看看", "next_scene": "pumpkin_patch"}
                ]
            },
            "witch_encounter": {
                "title": "女巫的誘惑",
                "description": "女巫咯咯笑著說：「當然可以騎，但你要小心不要被掃帚柄... 你知道的。」她揮了揮手，掃帚突然飛到你面前。\n\n「不過，」她神秘地笑著，「我的掃帚很挑剔，只有真正勇敢的人才能駕馭它。」",
                "choices": [
                    {"option": "A: 勇敢地跨上掃帚", "next_scene": "broom_ride_success"},
                    {"option": "B: 說「我更想騎你」", "next_scene": "witch_rejection"},
                    {"option": "C: 問「你的貓咪在哪裡？」", "next_scene": "cat_encounter"}
                ]
            },
            "broom_ride_success": {
                "title": "掃帚飛行成功",
                "description": "你成功跨上掃帚，它載著你在月光下飛翔！女巫在下面鼓掌：「太棒了！你是我見過最勇敢的騎士！」\n\n你們一起飛到屋頂，看著下面的派對。女巫靠近你，輕聲說：「現在... 讓我們做一些更刺激的事情。」",
                "choices": [
                    {"option": "A: 在屋頂上親吻女巫", "next_scene": "rooftop_romance"},
                    {"option": "B: 提議一起飛到更遠的地方", "next_scene": "moonlight_adventure"}
                ]
            },
            "rooftop_romance": {
                "title": "屋頂浪漫",
                "description": "在月光下，你和女巫在屋頂上擁吻。她的嘴唇溫暖而甜蜜，帶著魔法的味道。突然，她推開你，笑著說：「現在讓我們做一些真正的魔法！」\n\n她揮動魔杖，你們周圍出現了閃爍的星星，整個世界都變得浪漫起來。",
                "is_ending": true,
                "outcome": "🎉 完美結局！你和女巫在魔法星光下度過了難忘的萬聖節夜晚！\n\n你獲得了『魔法騎士』的稱號，並且學會了真正的愛情魔法。",
                "score": 100
            },
            "moonlight_adventure": {
                "title": "月光冒險",
                "description": "你們飛到更遠的地方，來到一個隱秘的月光湖。女巫說：「這裡是我的秘密花園，只有真正特別的人才能來到這裡。」\n\n在月光下，你們一起探索著彼此的內心，度過了最浪漫的夜晚。",
                "is_ending": true,
                "outcome": "🌙 浪漫結局！你和女巫在月光湖度過了最美好的時光！\n\n你獲得了『月光戀人』的稱號，並且永遠記住了這個神奇的夜晚。",
                "score": 90
            },
            "witch_rejection": {
                "title": "女巫的拒絕",
                "description": "女巫皺起眉頭：「你以為我是什麼？隨便的女巫嗎？」她揮動魔杖，你突然感覺身體變輕了...\n\n「既然你這麼無禮，就讓你體驗一下真正的『輕如羽毛』吧！」你開始飄浮在空中，無法控制方向。",
                "choices": [
                    {"option": "A: 道歉並請求原諒", "next_scene": "apology_accepted"},
                    {"option": "B: 試圖抓住什麼東西", "next_scene": "floating_mischief"}
                ]
            },
            "floating_mischief": {
                "title": "漂浮惡作劇",
                "description": "你試圖抓住什麼東西，但只能在空中飄浮。女巫在下面笑著：「這就是無禮的代價！」\n\n突然，你撞到了一個吊燈，燈泡爆裂，火花四濺。女巫驚叫：「我的天！快下來！」她揮動魔杖，你安全地降落到地面。",
                "is_ending": true,
                "outcome": "💥 搞笑結局！你因為無禮而漂浮，最後撞壞了吊燈！\n\n雖然結局有點尷尬，但至少你學會了對女巫要有禮貌。",
                "score": 30
            },
            "haunted_house": {
                "title": "鬼屋內部",
                "description": "你走進鬼屋，裡面燈光昏暗，牆上掛著古老的畫像。突然，一個半透明的鬼魂從牆壁中飄出來！\n\n「歡迎來到我的家，」鬼魂說，「我是這裡的主人，已經死了 200 年了。但我還是很... 活躍。」他對你眨了眨眼。",
                "choices": [
                    {"option": "A: 說「你看起來很寂寞」", "next_scene": "ghost_romance"},
                    {"option": "B: 問「你能觸摸實體嗎？」", "next_scene": "ghost_touch"},
                    {"option": "C: 試圖逃跑", "next_scene": "ghost_chase"}
                ]
            },
            "ghost_romance": {
                "title": "鬼魂的浪漫",
                "description": "鬼魂嘆了口氣：「是的，我確實很寂寞。200 年來，沒有人願意和我... 你知道的。」他的聲音帶著渴望。\n\n「但是，」他突然興奮地說，「如果你願意，我可以教你一些鬼魂的... 特殊技巧。」",
                "choices": [
                    {"option": "A: 說「我很感興趣」", "next_scene": "ghost_lessons"},
                    {"option": "B: 問「會不會很冷？」", "next_scene": "cold_encounter"}
                ]
            },
            "cold_encounter": {
                "title": "冰冷的相遇",
                "description": "鬼魂笑著說：「一開始會有點冷，但很快就會變暖的。讓我示範給你看...」\n\n他輕輕觸摸你的手，你感覺到一陣涼意，但同時又有一種奇異的溫暖。他的觸摸讓你感到既刺激又舒適。",
                "is_ending": true,
                "outcome": "❄️ 冰冷結局！你和鬼魂度過了奇異的夜晚！\n\n雖然有點冷，但你體驗到了前所未有的感覺。",
                "score": 70
            },
            "pumpkin_patch": {
                "title": "南瓜田的誘惑",
                "description": "你來到南瓜田，月光下的大南瓜看起來格外誘人。突然，一個穿著農夫裝的性感女郎從南瓜後面走出來。\n\n「歡迎來到我的南瓜田，」她說，「我是這裡的守護者。這些南瓜都很特別... 它們會回應你的慾望。」",
                "choices": [
                    {"option": "A: 問「南瓜會回應什麼慾望？」", "next_scene": "pumpkin_magic"},
                    {"option": "B: 說「我更想了解你」", "next_scene": "farmer_romance"}
                ]
            },
            "farmer_romance": {
                "title": "農夫的浪漫",
                "description": "農夫女郎對你的直接感到驚訝，然後笑了。「你很有趣，」她說，「我喜歡直接的人。」\n\n她靠近你，輕聲說：「那麼，你想要了解我的哪個方面呢？」她的眼睛閃爍著誘惑的光芒。",
                "choices": [
                    {"option": "A: 說「我想了解你的心」", "next_scene": "heart_to_heart"},
                    {"option": "B: 說「我想了解你的身體」", "next_scene": "physical_attraction"}
                ]
            },
            "heart_to_heart": {
                "title": "心靈交流",
                "description": "農夫女郎對你的回答感到感動。「你是一個真正的人，」她說，「我願意和你分享我的內心。」\n\n你們坐在南瓜田邊，分享著彼此的故事和夢想，度過了最美好的時光。",
                "is_ending": true,
                "outcome": "💕 心靈結局！你和農夫女郎建立了深厚的情感連接！\n\n你獲得了『心靈伴侶』的稱號，並且永遠記住了這個美好的夜晚。",
                "score": 85
            },
            "physical_attraction": {
                "title": "身體吸引",
                "description": "農夫女郎對你的直接感到興奮。「很好，」她說，「我喜歡誠實的人。」\n\n她拉著你的手，帶你到南瓜田的深處。「讓我們做一些真正有趣的事情，」她輕聲說。",
                "is_ending": true,
                "outcome": "🔥 激情結局！你和農夫女郎度過了火熱的夜晚！\n\n你獲得了『激情戀人』的稱號，並且永遠記住了這個充滿激情的夜晚。",
                "score": 90
            }
        };

        // 載入遊戲資料
        function loadGameData() {
            const saved = localStorage.getItem('tsextAdventureData');
            if (saved) {
                const data = JSON.parse(saved);
                gameState.unlockedAchievements = new Set(data.unlockedAchievements || []);
                gameState.unlockedBadges = new Set(data.unlockedBadges || []);
                gameState.playCount = data.playCount || 0;
                gameState.totalScore = data.totalScore || 0;
                gameState.allEndingsUnlocked = new Set(data.allEndingsUnlocked || []);
                gameState.allScenesVisited = new Set(data.allScenesVisited || []);
                gameState.punsTriggered = new Set(data.punsTriggered || []);
            }
        }

        // 儲存遊戲資料
        function saveGameData() {
            const data = {
                unlockedAchievements: Array.from(gameState.unlockedAchievements),
                unlockedBadges: Array.from(gameState.unlockedBadges),
                playCount: gameState.playCount,
                totalScore: gameState.totalScore,
                allEndingsUnlocked: Array.from(gameState.allEndingsUnlocked),
                allScenesVisited: Array.from(gameState.allScenesVisited),
                punsTriggered: Array.from(gameState.punsTriggered)
            };
            localStorage.setItem('tsextAdventureData', JSON.stringify(data));
        }

        // 檢查成就
        function checkAchievements(sceneId) {
            const newAchievements = [];
            
            // 檢查結局成就
            if (storyData[sceneId] && storyData[sceneId].is_ending) {
                const endingCondition = `ending_${sceneId}`;
                for (const [achievementId, achievement] of Object.entries(achievementsData)) {
                    if (achievement.condition === endingCondition && !gameState.unlockedAchievements.has(achievementId)) {
                        gameState.unlockedAchievements.add(achievementId);
                        newAchievements.push(achievementId);
                    }
                }
            }

            // 檢查特殊成就
            checkSpecialAchievements();

            // 顯示新成就
            newAchievements.forEach(achievementId => {
                showAchievementPopup(achievementId);
            });

            // 更新成就面板
            updateAchievementsPanel();
            updateStatsPanel();
            saveGameData();
        }

        // 檢查特殊成就
        function checkSpecialAchievements() {
            // 探索者成就
            if (gameState.visitedScenes.size >= 10 && !gameState.unlockedAchievements.has('explorer')) {
                gameState.unlockedAchievements.add('explorer');
                showAchievementPopup('explorer');
            }

            // 完美主義者成就
            if (gameState.allEndingsUnlocked.size >= 8 && !gameState.unlockedAchievements.has('completionist')) {
                gameState.unlockedAchievements.add('completionist');
                showAchievementPopup('completionist');
            }

            // 速度惡魔成就
            if (gameState.gameStartTime) {
                const playTime = (Date.now() - gameState.gameStartTime) / 1000 / 60; // 分鐘
                if (playTime <= 5 && !gameState.unlockedAchievements.has('speed_demon')) {
                    gameState.unlockedAchievements.add('speed_demon');
                    showAchievementPopup('speed_demon');
                }
            }

            // 萬聖節傳奇成就
            if (gameState.totalScore >= 1000 && !gameState.unlockedAchievements.has('halloween_legend')) {
                gameState.unlockedAchievements.add('halloween_legend');
                showAchievementPopup('halloween_legend');
            }
        }

        // 檢查徽章
        function checkBadges() {
            const newBadges = [];
            const now = new Date();
            const hour = now.getHours();
            const day = now.getDay();

            // 第一次遊玩
            if (gameState.playCount === 1 && !gameState.unlockedBadges.has('first_play')) {
                gameState.unlockedBadges.add('first_play');
                newBadges.push('first_play');
            }

            // 夜貓子
            if ((hour >= 22 || hour <= 2) && !gameState.unlockedBadges.has('night_owl')) {
                gameState.unlockedBadges.add('night_owl');
                newBadges.push('night_owl');
            }

            // 早起鳥
            if (hour >= 5 && hour <= 8 && !gameState.unlockedBadges.has('early_bird')) {
                gameState.unlockedBadges.add('early_bird');
                newBadges.push('early_bird');
            }

            // 週末戰士
            if ((day === 0 || day === 6) && !gameState.unlockedBadges.has('weekend_warrior')) {
                gameState.unlockedBadges.add('weekend_warrior');
                newBadges.push('weekend_warrior');
            }

            // 重複玩家
            if (gameState.playCount >= 5 && !gameState.unlockedBadges.has('repeat_player')) {
                gameState.unlockedBadges.add('repeat_player');
                newBadges.push('repeat_player');
            }

            // 午夜魔法
            if (hour === 0 && !gameState.unlockedBadges.has('midnight_magic')) {
                gameState.unlockedBadges.add('midnight_magic');
                newBadges.push('midnight_magic');
            }

            return newBadges;
        }

        // 顯示成就彈窗
        function showAchievementPopup(achievementId) {
            const achievement = achievementsData[achievementId];
            if (!achievement) return;

            const overlay = document.createElement('div');
            overlay.className = 'overlay';
            overlay.onclick = () => closeAchievementPopup();

            const popup = document.createElement('div');
            popup.className = 'achievement-popup';
            popup.innerHTML = `
                <div class="achievement-icon">${achievement.icon}</div>
                <div class="achievement-title">🏆 成就解鎖！</div>
                <div class="achievement-description">${achievement.name}</div>
                <div class="achievement-rarity rarity-${achievement.rarity}">${achievement.rarity.toUpperCase()}</div>
                <div class="achievement-description">${achievement.description}</div>
                <div class="achievement-actions">
                    <button class="share-btn" onclick="shareAchievement('${achievementId}')">分享成就 📤</button>
                    <button class="close-btn" onclick="closeAchievementPopup()">關閉</button>
                </div>
            `;

            document.body.appendChild(overlay);
            document.body.appendChild(popup);

            // 3秒後自動關閉
            setTimeout(() => {
                if (document.body.contains(popup)) {
                    closeAchievementPopup();
                }
            }, 5000);
        }

        // 關閉成就彈窗
        function closeAchievementPopup() {
            const overlay = document.querySelector('.overlay');
            const popup = document.querySelector('.achievement-popup');
            if (overlay) overlay.remove();
            if (popup) popup.remove();
        }

        // 分享成就
        function shareAchievement(achievementId) {
            const achievement = achievementsData[achievementId];
            const shareText = `🎃 我在 Tsext Adventure: Halloween Haunt 中解鎖了成就「${achievement.name}」！\n\n${achievement.description}\n\n#TsextAdventure #HalloweenHaunt #NSFWGame`;
            const shareUrl = window.location.href;

            showShareModal(shareText, shareUrl, achievement);
        }

        // 顯示分享模態框
        function showShareModal(text, url, achievement) {
            const overlay = document.createElement('div');
            overlay.className = 'overlay';
            overlay.onclick = () => closeShareModal();

            const modal = document.createElement('div');
            modal.className = 'achievement-popup';
            modal.innerHTML = `
                <div class="achievement-icon">${achievement.icon}</div>
                <div class="achievement-title">分享成就</div>
                <div class="achievement-description">選擇分享平台：</div>
                <div class="achievement-actions">
                    ${Object.entries(socialPlatforms).map(([platformId, platform]) => `
                        <button class="share-btn" onclick="shareToPlatform('${platformId}', '${encodeURIComponent(text)}', '${encodeURIComponent(url)}')">
                            ${platform.icon} ${platform.name}
                        </button>
                    `).join('')}
                    <button class="close-btn" onclick="closeShareModal()">取消</button>
                </div>
            `;

            document.body.appendChild(overlay);
            document.body.appendChild(modal);
        }

        // 關閉分享模態框
        function closeShareModal() {
            const overlay = document.querySelector('.overlay');
            const modal = document.querySelector('.achievement-popup');
            if (overlay) overlay.remove();
            if (modal) modal.remove();
        }

        // 分享到平台
        function shareToPlatform(platformId, text, url) {
            const platform = socialPlatforms[platformId];
            let shareUrl = '';

            switch (platformId) {
                case 'twitter':
                    shareUrl = `${platform.url}?text=${text}&url=${url}`;
                    break;
                case 'facebook':
                    shareUrl = `${platform.url}?u=${url}&quote=${text}`;
                    break;
                case 'instagram':
                    // Instagram 需要手動複製
                    navigator.clipboard.writeText(`${text}\n\n${url}`);
                    alert('已複製到剪貼板！請在 Instagram 中貼上。');
                    return;
                case 'threads':
                    shareUrl = `${platform.url}?text=${text}`;
                    break;
                case 'line':
                    shareUrl = `${platform.url}?url=${url}&text=${text}`;
                    break;
                case 'reddit':
                    shareUrl = `${platform.url}?url=${url}&title=${text}`;
                    break;
                case 'telegram':
                    shareUrl = `${platform.url}?url=${url}&text=${text}`;
                    break;
                default:
                    // 複製到剪貼板
                    navigator.clipboard.writeText(`${text}\n\n${url}`);
                    alert('已複製到剪貼板！');
                    return;
            }

            window.open(shareUrl, '_blank', 'width=600,height=400');
            closeShareModal();
        }

        // 切換成就面板
        function toggleAchievementsPanel() {
            const panel = document.getElementById('achievementsPanel');
            const toggle = document.getElementById('achievementsToggle');
            
            if (panel.classList.contains('open')) {
                panel.classList.remove('open');
                if (toggle) {
                    toggle.style.right = '0';
                }
            } else {
                panel.classList.add('open');
                if (toggle) {
                    toggle.style.right = '300px';
                }
            }
        }

        // 更新成就面板
        function updateAchievementsPanel() {
            const panel = document.getElementById('achievementsList');
            if (!panel) return;

            const unlockedCount = gameState.unlockedAchievements.size;
            const totalCount = Object.keys(achievementsData).length;
            
            let html = `
                <div style="text-align: center; margin-bottom: 15px; padding: 10px; background: rgba(139, 92, 246, 0.2); border-radius: 8px;">
                    <div style="font-size: 1.5em; color: #ff6b35; font-weight: bold;">${unlockedCount} / ${totalCount}</div>
                    <div style="font-size: 0.9em; color: #e0e0e0;">已解鎖成就</div>
                </div>
            `;

            html += Object.entries(achievementsData).map(([achievementId, achievement]) => {
                const isUnlocked = gameState.unlockedAchievements.has(achievementId);
                return `
                    <div class="achievement-item ${isUnlocked ? 'unlocked' : ''}" style="opacity: ${isUnlocked ? '1' : '0.5'}">
                        <div class="achievement-item-icon">${achievement.icon}</div>
                        <div class="achievement-item-text">
                            <div class="achievement-item-name">${achievement.name}</div>
                            <div class="achievement-item-desc">${achievement.description}</div>
                            ${isUnlocked ? '<div style="font-size: 0.7em; color: #ff6b35; margin-top: 3px;">✓ 已解鎖</div>' : '<div style="font-size: 0.7em; color: #666; margin-top: 3px;">🔒 未解鎖</div>'}
                        </div>
                    </div>
                `;
            }).join('');

            panel.innerHTML = html;
        }

        // 更新統計面板
        function updateStatsPanel() {
            document.getElementById('totalScore').textContent = gameState.totalScore;
            document.getElementById('playCount').textContent = gameState.playCount;
            document.getElementById('achievementCount').textContent = gameState.unlockedAchievements.size;
            document.getElementById('sceneCount').textContent = gameState.visitedScenes.size;
        }

        // 開始遊戲
        function startGame() {
            const playerName = document.getElementById('playerName').value.trim();
            if (!playerName) {
                alert('請輸入你的名字！');
                return;
            }

            gameState.playerName = playerName;
            gameState.currentScene = 'start';
            gameState.score = 0;
            gameState.visitedScenes.clear();
            gameState.gameStartTime = Date.now();
            gameState.playCount++;

            // 檢查徽章
            const newBadges = checkBadges();
            if (newBadges.length > 0) {
                newBadges.forEach(badgeId => {
                    const badge = badgesData[badgeId];
                    alert(`🏆 獲得徽章：${badge.name} - ${badge.description}`);
                });
            }

            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('statsPanel').style.display = 'block';
            document.getElementById('achievementsToggle').style.display = 'block';
            
            updateStatsPanel();
            updateAchievementsPanel();
            saveGameData();
            displayScene('start');
        }

        // 顯示場景
        function displayScene(sceneId) {
            const scene = storyData[sceneId];
            if (!scene) {
                alert('找不到場景資料！');
                return;
            }

            gameState.visitedScenes.add(sceneId);
            gameState.allScenesVisited.add(sceneId);

            let html = `
                <div class="scene-title">🎃 ${scene.title} 🎃</div>
                <div class="scene-description">${scene.description.replace(/\n/g, '<br>')}</div>
            `;

            if (scene.is_ending) {
                gameState.score += scene.score || 0;
                gameState.totalScore += scene.score || 0;
                gameState.allEndingsUnlocked.add(sceneId);
                
                // 檢查成就
                checkAchievements(sceneId);

                html += `
                    <div class="ending">
                        <div class="ending-title">🎭 結局：${scene.title}</div>
                        <div class="ending-outcome">${scene.outcome.replace(/\n/g, '<br>')}</div>
                        <div class="score">🏆 你的分數：${gameState.score}</div>
                        <div class="score">📍 探索場景數：${gameState.visitedScenes.size}</div>
                        <div class="score">🎯 總分數：${gameState.totalScore}</div>
                        <button class="restart-btn" onclick="restartGame()">重新開始 🎃</button>
                    </div>
                `;
            } else if (scene.choices) {
                html += '<div class="choices">';
                scene.choices.forEach((choice, index) => {
                    html += `
                        <div class="choice" onclick="makeChoice('${choice.next_scene}')">
                            ${choice.option}
                        </div>
                    `;
                });
                html += '</div>';
            }

            document.getElementById('gameArea').innerHTML = html;
        }

        // 做出選擇
        function makeChoice(nextScene) {
            displayScene(nextScene);
        }

        // 重新開始遊戲
        function restartGame() {
            gameState.currentScene = 'start';
            gameState.score = 0;
            gameState.visitedScenes.clear();
            gameState.gameStartTime = Date.now();
            gameState.playCount++;

            // 檢查徽章
            const newBadges = checkBadges();
            if (newBadges.length > 0) {
                newBadges.forEach(badgeId => {
                    const badge = badgesData[badgeId];
                    alert(`🏆 獲得徽章：${badge.name} - ${badge.description}`);
                });
            }

            updateStatsPanel();
            saveGameData();
            displayScene('start');
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            loadGameData();
            updateAchievementsPanel();
            updateStatsPanel();
            console.log('🎃 Tsext Adventure: Halloween Haunt 已載入！');
        });
    </script>
</body>
</html>
